<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0050)lesson078.htm -->
<HTML xmlns:mso="urn:schemas-microsoft-com:office:office" xmlns:msdt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882"><HEAD><TITLE>ﾏ&#57517;胙瑟頏魵瑙韃 浯 Visual C++</TITLE>

<!--[if gte mso 9]><xml>
<mso:CustomDocumentProperties>
<mso:xd_Signature msdt:dt="string"></mso:xd_Signature>
<mso:display_urn_x003a_schemas-microsoft-com_x003a_office_x003a_office_x0023_Editor msdt:dt="string">&#1050;&#1088;&#1091;&#1075;&#1083;&#1086;&#1074; &#1057;&#1077;&#1088;&#1075;&#1077;&#1081; &#1050;&#1086;&#1085;&#1089;&#1090;&#1072;&#1085;&#1090;&#1080;&#1085;&#1086;&#1074;&#1080;&#1095;</mso:display_urn_x003a_schemas-microsoft-com_x003a_office_x003a_office_x0023_Editor>
<mso:Order msdt:dt="string">11000.0000000000</mso:Order>
<mso:xd_ProgID msdt:dt="string"></mso:xd_ProgID>
<mso:_ExtendedDescription msdt:dt="string"></mso:_ExtendedDescription>
<mso:display_urn_x003a_schemas-microsoft-com_x003a_office_x003a_office_x0023_Author msdt:dt="string">&#1050;&#1088;&#1091;&#1075;&#1083;&#1086;&#1074; &#1057;&#1077;&#1088;&#1075;&#1077;&#1081; &#1050;&#1086;&#1085;&#1089;&#1090;&#1072;&#1085;&#1090;&#1080;&#1085;&#1086;&#1074;&#1080;&#1095;</mso:display_urn_x003a_schemas-microsoft-com_x003a_office_x003a_office_x0023_Author>
<mso:ComplianceAssetId msdt:dt="string"></mso:ComplianceAssetId>
<mso:TemplateUrl msdt:dt="string"></mso:TemplateUrl>
<mso:ContentTypeId msdt:dt="string">0x0101002C05377DDBA1DA4998D7B8B3F4A9A863</mso:ContentTypeId>
<mso:TriggerFlowInfo msdt:dt="string"></mso:TriggerFlowInfo>
<mso:_SourceUrl msdt:dt="string"></mso:_SourceUrl>
<mso:_SharedFileIndex msdt:dt="string"></mso:_SharedFileIndex>
</mso:CustomDocumentProperties>
</xml><![endif]-->
</HEAD>
<BODY background="../bgrwhite.gif">
      <CENTER><B>ﾓ&#57517;・VIII</B></CENTER></FONT>
      <P>
      <P align=center><FONT color=black face=ARIAL size=4>ﾏ&#57517;裲&#57887;&#57517;籵湜・
      蒻琿魲魵鵫 ・淲・</FONT></P>
<p>ﾊ魲萵 趺 &#63729;&#57893; ・煆頸・?! 
            <UL type=square>
              <LI>ﾎ&#57709;琿瑰・鈞粢&#57527;・&#59195;&#63731; &#57709;琅・, 淲髜&#58457;蒻・ 蒡矜粨&#57907; ・・
              ・&#57508;&#57511;&#57705;粲・鶴浯. 
              <LI>ﾂ ・裝鏸&#58092;頷 &#58083;鶴瑾 ・ &#58073;・・鈿瑕黑齏頌・・&#57705;磊&#57887;褌 
              <B>WM_PAINT</B>, ・・・鵰&#57712;鮏頸, ・聿・&#58090;瑰&#57889;・鶴浯 ・魲&#57503;・・ 
              韲褊濵 &#58090;瑰&#57889;・ &#57879;・・・&#57879; &#58819;&#57709;・・&#57893;&#57503;&#63731; 淲 &#57895;裔&#58072;・・&#57508;&#57511;&#57705;粲・淲 
              碯蒟・・&#57508;&#57511;&#57705;糺籵&#57907;・. 
              <LI>ﾂ鰀湜・褪 粽・ⅲ 褥&#57884;&#57709;粢澵・ ・・&#63729;&#57893; &#57695;褄瑣・ ﾎ&#57881;褪 ・ⅲ・ 
              &#57710;&#59200;&#57709;糒&#63730;・&#57879;・・・瑰&#57718;, ・・・&#57879;&#58255;鴉・ ・湜・・ 碯蒟・鈞・&#57718;籵&#57907; 
              糂襞 浯碚・胙瑶顆褥・・・・淸, ・&#57893;&#57530;・・ 碯蒟・・韲褊&#63731;&#57907;, ・・&#57893;・
              ・聿・淲髜&#58457;蒻・ 碯蒟・・&#57508;&#57511;&#57705;籵&#57907; 鶴濵 ・ ・ⅲ&#57893; 粽&#57706;&#57517;韈粢蒟・
              頷 韈 ・&#57879;&#58255;鴉・ ﾂⅳ 糂・&#57879;・・ⅲ&#57893;, &#57884;・&#57531; 碯蒟・蒟鴦&#57881;魵瑣・
              ・・・蓐・ 
              <LI>ﾏ褞糺・蒟・・蒡矜粨・・&#57508;・澵・-&#58077;珸瑣褄・・瑰&#57691; 
              <B>CMetaFileDC</B>. ﾄ髜珞・・・・瑰・<B>CPaintORamaDlg</B> 
              ・&#57508;・澵・ <B>m_pMF</B> ・&#57887;・・<B>CMetaFileDC*</B>. 
              <LI>ﾏⅳ黑 ・・淲・&#58274;渼&#58639;・<B>OnInitDialog</B> ・&#57508;・ⅰ褞瑣ⅱ黑 
              <B>return</B> 糂&#57879;紆&#57884; &#57702;裝・&#59203;・葢・&#57709;&#57517;&#58829;・ 
              <P><B>//ﾐ珸・&#57709;頸・・・・&#57887; 髜栁・ ・&#57879;&#58255;鴉・BR>m_pMF = new 
              CMetaFileDC;<BR>//ﾑ鰀萵&#57907; ﾌ褪獪琺・BR>m_pMF-&gt;Create();<BR></B>
              <P></P>
              <LI>ﾂ浯&#58819;・ 糺 &#57503;銕褥&#57887;・ 髜栁・ ・&#57879;&#58255;鴉・・蒻浯・&#58824;&#57701;鵫 ・・&#57887;. 
              <LI>ﾏⅳ黑 &#57705;鈕琿・&#57691;・・&#57879;&#58255;鴉. 
              <LI>ﾒ襃褞・・蒻&#58263;&#58639;&#57522;褌 ・・・&#58274;渼&#58639;・<B>OnClearbtn</B> 
              <LI>ﾊ&#57503;&#57704;隯 糺蒟・濵 &#57893;, &#58837;・浯蒡 蒡矜粨&#57907;. 
              <P><B>void CPaintORamaDlg::OnClearbtn() <BR>{<BR>CClientDC 
              dc(this);<BR><FONT color=red>//ﾇ瑕&#57530;&#57907; ・&#57879;&#58255;鴉<BR>HMETAFILE 
              hmf=m_pMF-&gt;Close();<BR>//ﾓ萵・&#57907; 萵澵鐱 ・
              ・&#57879;&#58255;鴉・BR>::DeleteMetaFile(hmf);<BR>delete hmf;
              <P>//C鰀萵&#57907; 濵糺・・&#57879;&#58255;鴉<BR>m_pMF=new 
              CMetaFileDC;<BR>m_pMF-&gt;Create();<BR>m_pMF-&gt;SetAttribDC(dc);<BR></FONT>//ﾇ瑕&#57503;&#57699;&#57907; 
              髜・&#57709;・&#57511;&#57705;籵湜&#63731; 砒・・
              &#58633;褪黑<BR>dc.SelectStockObject(NULL_PEN);<BR>dc.Rectangle(m_Canvas);
              <P><FONT color=red>//ﾇ瑜頌瑣・・・淸・・
              ・&#57879;&#58255;鴉<BR>m_pMF-&gt;SelectStockObject(NULL_PEN);<BR>m_pMF-&gt;Rectangle(m_Canvas.left,m_Canvas.top,<BR>m_Canvas.right+1,m_Canvas.bottom+1);<BR></FONT>}<BR></B></P>
              <LI>ﾄ髜珞・澵隆 ・・&#58071;琿&#63731;褪 ・&#57879;&#58255;鴉, &#57879;・・・・・浯赳&#57887;・浯 
              ・ⅰ・ <B>Clear</B> 糺 ⅸ顋瑯&#57884; 鶴濵 ・・・淲 &#57895;裔&#58072;・・&#57508;&#57511;&#57705;粲・ 
              ・&#57893;・糺 &#57705;鈕瑯&#57884; 濵糺・・&#57879;&#58255;鴉, 粽髜&#59200;・・・&#57892;・・&#58824;・. ﾇ瑣褌 糺 
              ⅸ顋瑯&#57884; &#63729;・瑙, ・鈞・&#57718;籵褪・&#63729;&#57887; ・・淸・・・&#57879;&#58255;鴉. 
              <LI>ﾏ鵫蒟・萵・&#59012;. ﾒ襃褞・・蒻&#58263;&#58639;&#57522;褌 &#58274;渼&#58639;&#63730; <B>DrawShape</B> 
              &#57702;裝・&#59203;・髜&#57503;鉋・
              <P><B>void CPaintORamaDlg::DrawShape(bool 
              stretch)<BR>{<BR>//ﾏ鸙&#58090;頸・髜栁・ ・炅裲&#57709;・
              &#58084;&#57895;鵫&#57709;籵<BR>CClientDC dc(this);
              <P>//ﾓ&#57709;瑙魵頸・瑣&#57511;碯&#57906; 
              DC<BR>dc.SetAttribDC(dc);<BR>dc.SelectObject(&amp;m_Brush);<BR><FONT 
              color=red>m_pMF-&gt;SetAttribDC(dc);</FONT><BR>dc.IntersectClipRect(m_Canvas);<BR><FONT 
              color=red>m_pMF-&gt;IntersectClipRect(m_Canvas);
              <P></FONT>//ﾏ鸙&#58090;頸・濵・・・鉅&#58639;・韈 &#57706;韭・浯鈔瑙韜 &#58263;胚・BR>int 
              drawmode=m_ShapesCombo.GetCurSel();
              <P>//ﾂ鎤&#57503;&#57907; 
              ・&#57517;<BR>dc.SelectObject(&amp;m_Pen);<BR>dc.SelectObject(&amp;m_Brush);<BR><FONT 
              color=red>//ﾇ瑜頌瑣・ⅰ褞瑣ⅱ・・
              ・&#57879;&#58255;鴉<BR>m_pMF-&gt;SelectObject(&amp;m_Pen);<BR>m_pMF-&gt;SelectObject(&amp;m_Brush);
              <P></FONT>//ﾌ褪鮏 &#57508;鉅濵粽・湜&#57887;<BR>if(stretch &amp;&amp; 
              drawmode!=0)<BR>{<BR>//ﾓ&#57709;瑙魵頸・・&#57893;・&#57508;鉅濵粽・
              湜&#57887;<BR>dc.SetROP2(R2_NOT);<BR>}
              <P>//ﾊ・&#57709;&#57522;・・ 糺碚&#57503; 
              &#58263;胚&#57530;<BR>switch(drawmode)<BR>{<BR>//ﾑ粽碚蓖鮱 &#57511;&#57705;籵湜・BR>case 
              0:<BR>dc.MoveTo(m_LineStart);<BR>dc.LineTo(m_LineEnd);<BR><FONT 
              color=red>//ﾇ瑜頌瑣・ⅰ褞瑣ⅱ・・
              ・&#57879;&#58255;鴉<BR>m_pMF-&gt;MoveTo(m_LineStart);<BR>m_pMF-&gt;LineTo(m_LineEnd);<BR></FONT>m_LineStart=m_LineEnd;<BR>break;<BR>
              <P>//ﾐ頌魵瑙韃 ・湜・BR>case 
              1:<BR>dc.MoveTo(m_LineStart);<BR>dc.LineTo(m_LineEnd);<BR><FONT 
              color=red>/*ﾇ瑜頌瑣・ⅰ褞瑣ⅱ・・・&#57879;&#58255;鴉, 褥・ 淲 糺碣瑙 &#57508;跖・
              &#57508;鉅濵粽・
              湜&#57887;*/<BR>if(!stretch)<BR>{<BR>m_pMF-&gt;MoveTo(m_LineStart);<BR>m_pMF-&gt;LineTo(m_LineEnd);<BR>}<BR></FONT>break;<BR>
              <P>//ﾐ頌魵瑙韃 &#63729;・・魵<BR>case 
              2:<BR>dc.Ellipse(CRect(m_LineStart,m_LineEnd));<BR><FONT 
              color=red>//ﾇ瑜頌瑣・ⅰ褞瑣ⅱ・・
              ・&#57879;&#58255;鴉<BR>if(!stretch)<BR>{<BR>m_pMF-&gt;Ellipse(CRect(m_LineStart,m_LineEnd));<BR>}<BR></FONT>break;<BR>
              <P>//ﾐ頌魵瑙韃 ・&#63731;・&#58070;鸙・韭・BR>case 
              3:<BR>dc.Rectangle(CRect(m_LineStart,m_LineEnd));<BR><FONT 
              color=red>//ﾇ瑜頌瑣・ⅰ褞瑣ⅱ・・
              ・&#57879;&#58255;鴉<BR>if(!stretch)<BR>{<BR>m_pMF-&gt;Rectangle(CRect(m_LineStart,m_LineEnd));<BR>}<BR></FONT>break;<BR>}<BR><BR>}<BR></B></P>
              <LI>ﾇ蒟&#57719; ・趾隆 ⅰ褞瑣ⅱ, ・&#57893;&#57530;・淲・&#57707;裝&#57709;粢澵・&#57693;&#63731;鈞・・
              &#57511;&#57705;籵湜褌 鈞・&#57718;籵褪・ ・・&#57879;&#58255;鴉. 
              <LI>ﾂ・ 浯粢&#57516;鮱, 髜&#57503;&#57887;・ 粹韲瑙韃 浯 ・瀨&#57895;&#58077;&#58639;&#63730; ⅰ褞瑣ⅱ・
              <B>IF</B>. ﾏ&#57511; 鈞・&#57699; ・・&#57879;&#58255;鴉, ・ ・魵褞&#63731;褪 淲 粲・&#58824;・・ &#57508;跖・
              &#57508;鉅濵粽・湜&#57887;, &#57879;・・・浯・炫跫・&#57893;・・ ・淲&#58832;鐱 &#58263;胚&#57530;, ・淲 &#57884;, 
              ・&#57893;&#57530;・浯&#57511;&#57705;籵燾 ・&#57893;蒡・&#57508;鉅濵粽・湜&#57887;. 
              <LI>ﾒ襃褞・蒡矜粨・・・淲・&#57707;裝&#57709;粢澵・・&#58274;渼&#58639;&#63730; <B>OnPaint</B>, 
              ・&#57893;&#57530;・・碯蒟・糂・・&#57508;&#57511;&#57705;糺籵&#57907; 鶴濵 ・魲&#57503;・・ 
              <LI>ﾎ&#57889;&#57517;鶯・鶴濵 &#58274;渼&#58639;&#63730; <B>OnPaint</B> ・&#58071;琿頸・粢&#57719; ・・韈 淲・
              ・蒡矜紆&#57884; &#57702;裝・&#59203;・
              <P><B>void CPaintORamaDlg::OnPaint() <BR>{<BR>CPaintDC dc(this);
              <P>//ﾇ瑕&#57530;&#57887;・・&#57879;&#58255;鴉・BR>HMETAFILE 
              hmf=m_pMF-&gt;Close();<BR>//ﾂⅲ・鵰鈔裝褊韃 
              ・&#57879;&#58255;鴉・BR>dc.PlayMetaFile(hmf);
              <P>//ﾏ&#57511;&#57693;琲籵湜・&#58077;珸瑣褄&#63731; 浯 &#57709;瑩隆 髜栁・ ・&#57508;・澵鵫 
              temp<BR>CMetaFileDC* temp=new CMetaFileDC;<BR>//ﾇ瑕&#57530;&#57887;・
              髜栁・・BR>temp-&gt;Create();<BR>//ﾏ&#57517;鞳&#57517;籵湜・
              ・&#57879;&#58255;鴉・BR>temp-&gt;PlayMetaFile(hmf);<BR><BR>//ﾓ萵・湜・
              ・&#57879;&#57709;&#57522;・&#58083;・・・&#57879;&#58255;鴉・BR>DeleteMetaFile(hmf);<BR>delete 
              hmf;<BR><BR>//ﾏ&#57511;&#57693;琲籵湜・糅褌褊濵胛 &#58077;珸瑣褄&#63731; 
              ・&#57709;・澵黑・BR>m_pMF=temp; <BR>/*ﾅ&#57702;・・&#57505;隆 &#57503;・磊・ 糺鈔瑙・
              &#58274;渼・ OnPaint, &#57893; 糺鈞籵&#57907; ⅸ頌&#57889;・&#63729;・瑙・/<BR>static 
              firstTime=TRUE;<BR>if(firstTime)<BR>{<BR>OnClearbtn();<BR>firstTime=FALSE;<BR>}<BR><BR>}<BR></B></P>
              <LI>ﾐ珸砒&#57508;・&#63731; ・&#63729;&#57893;・&#58838;&#59035;&#63730;. ﾗ&#57893;磊 ・&#57879;&#58255;鴉 粽&#57706;&#57517;韈粢&#57709;・裙・浯蒡 
              鈞・靑・ 濵 &#58837;髜・糂・・・淸・&#57705;&#58459;瑙頸・ ・ ・・銛褌・ 糅褌褊濵・
              ・&#57508;・澵鵫 <B>temp</B>, ・・&#57893;&#57522;&#63730; 鈞・&#57718;籵褌 粢&#57719; 浯碚・・・淸, 
              ・&#57893;・・ &#58071;琿&#63731;褌 ・&#57879;&#58255;鴉 ・・&#57879;&#57709;&#57522;・&#58083;・ ・・頌籵鞣瑯・&#58077;珸瑣褄・
              糅褌褊濵・・&#57508;・澵鵫 ・&#57709;・澵鵫, &#57879;・・髜&#57503;鉋・・ ・・&#58827;・ 粢&#57719; 
              浯碚・・・淸. 
              <LI>ﾅ&#57702;・&#58274;渼&#58639;&#63731; <B>OnPaint</B> 鈞・&#57701;瑯&#57896;&#63731; ・&#57505;隆 &#57503;・ &#57893; 浯・
              淲髜&#58457;蒻・ 鈞・・頸・・・淸・ⅸ頌&#57889;・&#63729;・瑙・ 
              <LI>ﾈ 浯 ・&#57702;裝鶴 &#58457;&#57884;・&#57719; 磊 &#58071;琿頸・・&#57709;・澵隆 ・&#57879;&#58255;鴉. 
              <LI>ﾄ・ &#63729;&#57893;胛 籵・淲髜&#58457;蒻・ ・・・&#59223;&#63730; <B>Class Wizard</B> &#57693;&#63731;鈞&#57907; 
              ・・・&#57705;磊&#57887;褌 <B>WM_DESTROY</B>, ・&#57893;&#57517;・・鵰&#57712;鮏頸 ・・
              鈞粢&#57527;褊韋 ・魲&#57503;・・ 
              <LI>ﾑ・跖&#57884; ・・・&#57705;磊&#57887;褌, &#58068;裝頸褥・ &#58837;・・・&#63729;&#57893;・磊・糺碣瑙 
              ・瑰・<B>CPaintORamaDlg</B>. ﾈ ﾄ髜珞・・&#57702;裝・&#59203;・・・
              <P><B>void CPaintORamaDlg::OnDestroy() 
              <BR>{<BR>CDialog::OnDestroy();<BR>////-ﾂ璧 ・・浯&#58827;浯褪・ 
              鈕褥・////
              <P>//ﾇ瑕&#57530;&#57907; ・&#58071;琿頸・・&#57879;&#58255;鴉<BR>m_pMF-&gt;Close();<BR>delete 
              m_pMF;
              <P>////-ﾂ璧 ・・浯&#58827;浯褪・ 鈕褥・////
              <P>}<BR></B>
              <P></P>
              <LI>ﾎ&#57889;黑・・&#57522;鶯・・鈞・&#57709;頸・・魲&#57503;・・ 浯蒟&#63730;&#57719; ・・淲 糺萵&#57709; 
              ⅹ鞦鶴:) ﾏ褞褪瓊頸・碚・&#59026;&#63730; &#58819;&#57907; 髜・&#57709;・&#57511;&#57705;籵湜&#63731; 鈞 &#63729;・瑙 ・
              粢&#57516;頸・・&#57893;・髜&#57503;&#57892;・ 褥・ 糂・・&#57508;&#57511;&#57705;籵・&#57719;, &#57893; 糺 ・・蒟・ 
              褥・ 淲・ &#57893; &#63731; ・ⅶ鵫, ・籵・・鞴褪・ &#57699;蒟&#57907; ・・&#57511;&#57907; 糂・・
              浯&#58819;・:) 
              <LI>ﾂⅳ 浯 &#63729;&#57893;・・ ・鈞・煆韲 浯&#59026; ・魲&#57503;・・ ﾊ・褶濵, ・跫・磊・ 
              磊 &#57695;褄瑣・ⅳ・靑韃 BMP &#58255;鴉魵 ・頷 &#57508;萵・頏魵瑙韃, ・・&#57893;・
              鈞・&#57719;, 濵 蔘・&#63730; 籵・・・ &#63729;&#57893;胛 &#58445;瑣頸! 
              <LI>ﾅ&#57702;・&#58457;&#57887;&#57884; 糂・・頸・ &#58837;・糺 &#58074;浯・ 韈 &#63729;&#57893;胛 &#58083;鶴・ ・&#58837;・&#63729;&#57893; 
              籵・萵・, 齏・・趺・湜&#58824;胛 淲 萵・, &#57893; ・ⅸ頸琺&#57884; &#57508;・・. 
            </LI></UL><BR><BR>ﾐ裼&#63730;・!ﾏ&#57517;&#58827;&#57879;・<BR>
            <CENTER><A 
            href="lesson068.htm"><B 
            class=base2>&lt;-ﾍ珸琅</B></A> || <A 
            href="lesson088.htm"><B 
            class=base2>ﾄ琿・・-&gt;</B></A>
            <P></CENTER>
            <P>
            <CENTER><B><FONT color=green><A 
            href="lesson008.htm">[1]</A><A 
            href="lesson018.htm"> [2]</A> 
            <A 
            href="lesson028.htm">[3]</A><A 
            href="lesson038.htm"> [4]</A><A 
            href="lesson048.htm"> [5] 
            </A><A 
            href="lesson058.htm">[6]</A><A 
            href="lesson068.htm"> [7]<A> 
            [8] <A 
            href="lesson088.htm">[9]</A></B></FONT></CENTER></FONT>
<p><div align="center"><a href="lesson.htm"><img src="../soder.gif" width=120 height=31 border=0 alt=""></a></div></p>		
</BODY></HTML>
