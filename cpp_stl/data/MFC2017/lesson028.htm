<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0050)lesson028.htm -->
<HTML xmlns:mso="urn:schemas-microsoft-com:office:office" xmlns:msdt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882"><HEAD><TITLE>ﾏ&#57517;胙瑟頏魵瑙韃 浯 Visual C++</TITLE>

<!--[if gte mso 9]><xml>
<mso:CustomDocumentProperties>
<mso:xd_Signature msdt:dt="string"></mso:xd_Signature>
<mso:display_urn_x003a_schemas-microsoft-com_x003a_office_x003a_office_x0023_Editor msdt:dt="string">&#1050;&#1088;&#1091;&#1075;&#1083;&#1086;&#1074; &#1057;&#1077;&#1088;&#1075;&#1077;&#1081; &#1050;&#1086;&#1085;&#1089;&#1090;&#1072;&#1085;&#1090;&#1080;&#1085;&#1086;&#1074;&#1080;&#1095;</mso:display_urn_x003a_schemas-microsoft-com_x003a_office_x003a_office_x0023_Editor>
<mso:Order msdt:dt="string">8300.00000000000</mso:Order>
<mso:xd_ProgID msdt:dt="string"></mso:xd_ProgID>
<mso:_ExtendedDescription msdt:dt="string"></mso:_ExtendedDescription>
<mso:display_urn_x003a_schemas-microsoft-com_x003a_office_x003a_office_x0023_Author msdt:dt="string">&#1050;&#1088;&#1091;&#1075;&#1083;&#1086;&#1074; &#1057;&#1077;&#1088;&#1075;&#1077;&#1081; &#1050;&#1086;&#1085;&#1089;&#1090;&#1072;&#1085;&#1090;&#1080;&#1085;&#1086;&#1074;&#1080;&#1095;</mso:display_urn_x003a_schemas-microsoft-com_x003a_office_x003a_office_x0023_Author>
<mso:ComplianceAssetId msdt:dt="string"></mso:ComplianceAssetId>
<mso:TemplateUrl msdt:dt="string"></mso:TemplateUrl>
<mso:ContentTypeId msdt:dt="string">0x0101002C05377DDBA1DA4998D7B8B3F4A9A863</mso:ContentTypeId>
<mso:TriggerFlowInfo msdt:dt="string"></mso:TriggerFlowInfo>
<mso:_SourceUrl msdt:dt="string"></mso:_SourceUrl>
<mso:_SharedFileIndex msdt:dt="string"></mso:_SharedFileIndex>
</mso:CustomDocumentProperties>
</xml><![endif]-->
</HEAD>
<BODY background="../bgrwhite.gif">
      <CENTER><B>ﾓ&#57517;・VIII</B></CENTER></FONT>
      <P>
      <P align=center><FONT color=black face=ARIAL size=4>ﾏ&#57517;裲&#57887;&#57517;籵湜・
      蒻琿魲魵鵫 ・淲・</FONT></P>
     
  ﾍ・&#58837;・ 胛&#57893;糺 ・鮏鸙跖&#57907; 
            浯&#59012; ・&#57884;&#59012;&#57709;粨・ ﾊ・褶濵, 胛&#57893;糺. ﾏ鮱&#58443;・ 萵・&#59012;! 
            <UL type=square>
              <LI>ﾒ襃褞・浯・淲髜&#58457;蒻・ 蒡矜粨&#57907; ・・&#57511;&#57705;籵湜&#63731;, 頌・・銛鶯・
              &#57702;裝・&#59203;・竟&#57709;&#57522;・韋 蓁&#63731; &#63729;&#57893;胛: 
              <LI>ﾂ浯&#58819;・ 籵・淲髜&#58457;蒻・ &#57693;&#63731;鈞&#57907; ・・・浯赳&#57887;褌 浯 ・糒&#63730; ・ⅰ・ 
              ・&#59015;, 粽-・&#57505;顥 浯・淲髜&#58457;蒻・ ・魵褞頸・磊・ ・ 糺・・褊・浯赳&#57887;・
              ・髜・&#57709;・&#57511;&#57705;籵湜&#63731;, 粽-糘ⅱ顥 鈞&#58445;瑣頸・・&#59035;! </LI></UL>
            <UL type=square>
              <P><FONT color=red size=+1><B>ﾑ・鍄籵湜・・萵 ・&#57705;磊&#57887;褌 
              WM_LBUTTONDOWN</B></FONT></P>
              <LI>ﾄ髜珞・・・・瑰・<B>CPaintORamaDlg</B> 葢・・&#57508;・澵鐱 
              <B>m_LineEnd</B> ・<B>m_LineStart</B>, &#57887;・・&#57508;・澵顥 - 
              <B>CPoint</B>, 蒡&#57709;&#58082; <B>Private</B>, 褥・ 鈞磊・, ・・&#63729;&#57893; 蒟・&#57907; 
              粢&#57516;頸褥・浯 &#57709;&#57503;湜&#58829;・浯鈞・・・&#57703;ⅳ&#57511;&#57884; &#59007;肛 蓁&#63731; 蒡矜粱褊・ 
              ・&#57508;・澵鵫 <B>m_Cavas</B>. ﾏ&#57511; 浯赳&#57887;・浯 ・ⅰ・ ・&#59015; ・魲&#57503;・・
              <B>PaintORama</B> 蒡・浯 ・魵褞頸・磊・・ 糺・・褊 &#59200;・鶴 ・
              髜・&#57709;・&#57511;&#57705;籵湜&#63731;, ・・頌粽頸・・ⅱ蒻浯&#57906; 浯&#58819;・ (X,Y) ・&#57508;・澵鵫 
              <B>m_LineStart</B> ・<B>m_LineEnd</B>,・&#57702;裝・&#63731; ・&#57508;・澵・ 碯蒟・
              ・&#57709;・澵・・・&#57907;・, ・・&#57505;・ 碯蒟・&#58459;瑙頸・裹 ・裝鏸&#58092;裹 鈿璞褊韋. 

              <LI>ﾂ靃鸙湜&#57884; &#57702;裝・&#59203;・&#59007;肛:<BR><B>1)</B> ﾎ&#57889;&#57517;鶯・・
              <B>Workspace</B> 鈞・琅・ <B>Class View</B>, ⅳ・鵫&#57884; ・瑰・
              <B>CPaintORamaDlg</B>. ﾂ鑈魵頸・・炅裲&#57704;鮱 ・・ ・珞鵫 ・ⅰ・・
              ・&#59015;, 糺礪&#57511;&#57884; &#57879;・<B>Add Windows Message Handler...</B>, ・&#63731;粨&#57896;&#63731; 
              &#57879;・・蒻琿魲魵鮱 鶴濵: </LI></UL>
      
              <P align=center><IMG src="lesson028.files/vc_add_func_btdown.gif"    width=440></P>
 <UL type=round>  <LI>ﾂ &#57706;頌・ <B>Class to object to handle</B> &#58068;裝頸褥・ &#58837;・
              糺碣瑙 ・瑰・<B>CPaintORama</B> . ﾂ &#57706;頌・ &#57705;髜&#59200;湜・<B>New 
              Windows message/events</B> 糺礪&#57511;&#57884; <B>WM_LBUTTONDOWN</B>. 
              <LI>ﾍ琥・&#57884; ・ⅰ・ <B>Add and Edit</B>. 
              <LI>ﾓ 籵・・&#63731;粨&#57896;&#63731; 鶴濵 &#57508;萵・頏魵瑙・, 粐裝頸・&#57702;裝・&#59203;・・・ 
              <P><B>BOOL CPaintORamaDlg::OnLButtonDown(UINT nFlags, CPoint 
              point) <BR>{<BR><BR>.....<BR>
              <P>/////-ﾂ璧 ・・浯&#58827;浯褪・ 鈕褥・///
              <P>//ﾏ&#57517;粢&#57511;&#57907; 磊・ ・ 浯赳&#57887;・粹&#58085;&#57511; 髜・&#57709;・
              &#57511;&#57705;籵湜&#63731;.<BR>if(m_Canvas.PtInRect(point))<BR>{<BR>//ﾏ&#57511;&#57693;鵰&#57907; 
              ・ⅱ蒻浯&#57906; 浯&#58819;・ 葢&#58079; ・&#57508;・澵隯<BR>m_LineStart= 
              point;<BR>m_LineEnd=point;
              <P>//ﾇ瑾籵&#57887;&#57907; ・&#59035;<BR>SetCapture();<BR>}
              <P>/////-ﾂ璧 ・・鈞・煆鞣瑯&#57896;&#63731; 鈕褥・/////
              <P>}<BR></B></P>
              <LI>ﾎ・&#57503;&#57893;・<B>IF</B> ・魵褞&#63731;褪 磊・ ・ 浯赳&#57887;・粹&#58085;&#57511; 髜・&#57709;・
              &#57511;&#57705;籵湜&#63731;, 蓁&#63731; &#63729;&#57893;胛 頌・・銛褪・ &#58274;渼&#58639;&#63731; <B>PtInRect</B>, 
              <LI>ﾅ&#57702;・&#58084;・粨・糺・・&#63731;褪・, &#57893; 竟頽鞨・鉅&#57517;籵&#57907; ・ⅱ蒻浯&#57906; ・煜・
              ・浯&#58819;・ 鈿璞褊・・ &#57884;・&#59200;胛 浯赳&#57887;&#63731;. 
              <LI>ﾏⅲ・蓖韲 ⅰ褞瑣ⅱ黑 糺 鈞&#58445;瑣鏆瑯&#57884; ・&#59035;, 蓁&#63731; &#57893;胛 &#58837;髜・
              &#57705;髜&#59200;湜・ &#58837;・・ⅰ・ ・&#59015; ⅳ・&#59200;浯 淲 ・鵰&#57712;鮏齏・・聿・糺 
              ⅳ・&#57887;・ 裹 鈞 跛&#57503;濵・・魲&#57503;・・ ﾊ・&#57507;竟瑣・浯&#58819;・ ・浯・・・&#58824;燾 
              籵・淲髜&#58457;蒻・ 粐褥&#57887; &#57691;・・・&#57511;&#57705;籵湜&#63731;. 
              <LI>ﾝ&#57898; 鈞萵&#58838; ・浯・碯蒟・&#57508;&#59007;&#57907; &#58274;渼&#58639;&#63731;, ・&#57893;&#57503;&#63731; &#57693;&#63731;鈞浯 ・
              &#57705;髜&#59200;湜褌 ・・&#57508;葢韆褊韋 ・&#59015;. 
              <LI>ﾒ襃褞・浯・淲髜&#58457;蒻・ &#57693;&#63731;鈞&#57907; ・・・&#57705;磊&#57887;褌 
              <B>WM_MOUSEMOVE</B>, 糺・・頸・&#57702;裝・&#59203;・蒟鴦&#57881;・: </LI></UL>
            <UL type=round>
              <LI>ﾂ鎤褞褪・<B>ClassWizard</B> ・・・ <B>View</B> 
              <LI>ﾂ鎤褞褪・鈞・琅・ <B>Message Maps</B> ・・淲・ 
              <B>ClassWizard</B> 
              <LI>ﾈ&#57706;鸙・&#58076;&#57884; 蒻琿魲魵・ ・淲・ <B>ClassWizard</B> 蓁&#63731; 糺碚&#57503; 
              &#57702;裝・&#59200;胛 &#57705;磊&#57887;&#63731;:<BR><LEFT><B>Class Name: 
              CPaintORamaDlg<BR>Object ID: CPaintORama<BR>Messages: 
              WM_MOUSEMOVE<BR></B></LEFT>
              <LI>ﾙ褄・頸・浯 ・ⅰ・ <B>Add Fucntion</B> . </LI></UL>
            <UL type=square>
              <LI>ﾍ琥・&#57884; ・ⅰ・ <B>Edit Code</B> ・浯・&#59015;&#57884; &#57702;裝・&#59203;・・・・
              &#58274;渼&#58639;・<B>OnMouseMove</B>: 
              <P><B>void CPaintORamaDlg::OnMouseMove(UINT nFlags, CPoint 
              point)<BR>{<BR>////-ﾂ璧 ・・浯&#58827;浯褪・ 鈕褥・////
              <P>if( (nFlags &amp; MK_LBUTTON) &amp;&amp; 
              m_Canvas.PtInRect(point))<BR>{
              <P>//ﾏ鸙&#58090;頸・&#58077;珸瑣褄・浯 ・炅裲&#57709; &#58084;&#57895;鵫&#57709;籵<BR>CClientDC 
              dc(this);
              <P>//ﾏ&#57511;&#57693;鵰&#57907; ・ⅱ蒻浯&#57906; &#59200;・・ ・&#57508;・澵鵫 
              m_LineEnd<BR>m_LineEnd= point;
              <P>//ﾍ瑩頌魵瑣・
              ・湜&#63730;<BR>dc.MoveTo(m_LineStart);<BR>dc.LineTo(m_LineEnd)
              <P>/*ﾏ&#57511;&#57693;鵰&#57907; &#57884;・&#59200;・・&#57508;・澵鵫 m_LineStart 鈿璞褊韃 ・鉅&#58639;・
              ・&#57520;ⅱ・/ <BR>m_LineStart=m_LineEnd;<BR>}
              <P>////-ﾂ璧 ・・鈞・&#58827;籵褪・ 鈕褥・////
              <P>} </B></P>
              <LI>ﾂ &#58084;・粨・ⅰ褞瑣ⅱ・<B>IF</B> ・魲&#57503;・・・魵褞&#63731;褪 浯赳&#57879; ・ 
              ・籵&#63731; ・ⅰ・ ・&#58837;・・&#57520;ⅱ 浯&#58457;蒻&#57896;&#63731; ・髜・&#57709;・&#57511;&#57705;籵湜&#63731;. 
              <LI>ﾂ浯&#58819;・ 糺 ・・&#58827;・ &#58077;珸瑣褄・・炅裲&#57709; &#58085;&#57517;鴦&#57881;・ &#57884;・&#57531; ・跫・
              &#57511;&#57705;籵&#57907;. 
              <LI>ﾇ瑣褌 ・頌籵鞣瑯&#57884; ・ⅱ蒻浯&#57906; ・&#57520;ⅱ・・&#57508;・澵鵫 
              <B>m_LineEnd</B>. 
              <LI>ﾏⅳ黑 葢・ⅰ褞瑣ⅱ・&#57511;&#57710;&#63730;・・湜&#63730;, ・・&#57702;裝湜・ⅰ褞瑣ⅱ 
              ・頌籵鞣瑯・&#57884;・&#59200;・・・趺湜・・&#57520;ⅱ・・&#57508;・澵鵫 m_LineStart</B>, 
              &#63729;&#57893; 鈿璞褊韃 碯蒟・&#63731;粱&#63731;&#57907;・ 浯&#58819;・・蓁&#63731; &#57702;裝・&#59200;胛 &#57511;&#57705;籵・・・湜・
              ・&#57702;・・&#57508;葢韆褊・ ・&#59015;. 
              <P>
              <P><FONT color=red size=+1><B>ﾑ・鍄籵湜・・萵 ・&#57705;磊&#57887;褌 
              WM_LBUTTONUP</B></FONT></P>
              <LI>ﾏ&#57511; ⅳ・&#57701;瑙韋 ・ⅰ・ ・&#59015; ・魲&#57503;・・<B>PaintORama</B> 蒡・浯 
              ⅳ・&#57709;頸・・&#59035;, ・&#57893;&#57522;&#63730; ・ 鈞&#58445;瑣齏・・&#58274;渼&#58639;・
              <B>OnLButtonDown</B>. 
              <LI>ﾂ靃鸙湜&#57884; &#57702;裝・&#59203;・&#59007;肛:<BR><B>1)</B> ﾎ&#57889;&#57517;鶯・・
              <B>Workspace</B> 鈞・琅・ <B>Class View</B>, ⅳ・鵫&#57884; ・瑰・
              <B>CPaintORamaDlg</B>. ﾂ鑈魵頸・・炅裲&#57704;鮱 ・・ ・珞鵫 ・ⅰ・・
              ・&#59015;, 糺礪&#57511;&#57884; &#57879;・<B>Add Windows Message Handler...</B>. 
              <LI>ﾂ &#57706;頌・ <B>Class to object to handle</B> &#58068;裝頸褥・ &#58837;・
              糺碣瑙 ・瑰・<B>CPaintORama</B> . ﾂ &#57706;頌・ &#57705;髜&#59200;湜・<B>New 
              Windows message/events</B> 糺礪&#57511;&#57884; <B>WM_LBUTTONUP</B>. 
              <LI>ﾍ琥・&#57884; ・ⅰ・ <B>Add and Edit</B>. 
              <LI>ﾓ 籵・・&#63731;粨&#57896;&#63731; 鶴濵 &#57508;萵・頏魵瑙・, 粐裝頸・&#57702;裝・&#59203;・・・ 
              <P><B>void CPaintORamaDlg::OnLButtonUp(UINT nFlags, CPoint point) 
              <BR>{<BR>////-ﾂ璧 ・・浯&#58827;浯褪・ 鈕褥・//// 
              <P>ReleaseCapture();
              <P>////-ﾂ璧 ・・鈞・煆鞣瑯&#57896;&#63731; 鈕褥・////
              <P>}
              <P></B></P></LI></UL>ﾇ瑜&#58084;&#57887;&#57884; ・魲&#57503;・・・・・髜&#58076;&#57884; 浯&#57511;&#57705;籵&#57907; 
            &#58837;・湜碯蕈. 
            <P><div align="center"><BR><BR>ﾄ髜珞・湜・粽銕鮻濵&#57709;・糺碚&#57503; &#58633;褪・・&#57503; ・&#57503;銕褞・<BR><A 
            href="lesson018.htm"><B 
            class=base2>&lt;-ﾍ珸琅</B></A> || <A 
            href="lesson038.htm"><B 
            class=base2>ﾄ琿・・-&gt;</B></A></div> 
            <P>
            <CENTER><B><FONT color=green><A 
            href="lesson008.htm">[1]</A><A 
            href="lesson018.htm"> [2]</A> 
            [3]<A href="lesson038.htm"> 
            [4]</A><A href="lesson048.htm"> 
            [5] </A><A 
            href="lesson058.htm">[6]</A><A 
            href="lesson068.htm"> [7]<A> <A 
            href="lesson078.htm">[8]</A> <A 
            href="lesson088.htm">[9]</A></B></FONT></CENTER></FONT></FONT>
<p><div align="center"><a href="lesson.htm"><img src="../soder.gif" width=120 height=31 border=0 alt=""></a></div></p>		
</BODY></HTML>
