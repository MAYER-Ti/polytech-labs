<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0050)lesson010.htm -->
<HTML xmlns:mso="urn:schemas-microsoft-com:office:office" xmlns:msdt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882"><HEAD><TITLE>ﾏ&#57517;胙瑟頏魵瑙韃 浯 Visual C++</TITLE>

<!--[if gte mso 9]><xml>
<mso:CustomDocumentProperties>
<mso:xd_Signature msdt:dt="string"></mso:xd_Signature>
<mso:display_urn_x003a_schemas-microsoft-com_x003a_office_x003a_office_x0023_Editor msdt:dt="string">&#1050;&#1088;&#1091;&#1075;&#1083;&#1086;&#1074; &#1057;&#1077;&#1088;&#1075;&#1077;&#1081; &#1050;&#1086;&#1085;&#1089;&#1090;&#1072;&#1085;&#1090;&#1080;&#1085;&#1086;&#1074;&#1080;&#1095;</mso:display_urn_x003a_schemas-microsoft-com_x003a_office_x003a_office_x0023_Editor>
<mso:Order msdt:dt="string">6500.00000000000</mso:Order>
<mso:xd_ProgID msdt:dt="string"></mso:xd_ProgID>
<mso:_ExtendedDescription msdt:dt="string"></mso:_ExtendedDescription>
<mso:display_urn_x003a_schemas-microsoft-com_x003a_office_x003a_office_x0023_Author msdt:dt="string">&#1050;&#1088;&#1091;&#1075;&#1083;&#1086;&#1074; &#1057;&#1077;&#1088;&#1075;&#1077;&#1081; &#1050;&#1086;&#1085;&#1089;&#1090;&#1072;&#1085;&#1090;&#1080;&#1085;&#1086;&#1074;&#1080;&#1095;</mso:display_urn_x003a_schemas-microsoft-com_x003a_office_x003a_office_x0023_Author>
<mso:ComplianceAssetId msdt:dt="string"></mso:ComplianceAssetId>
<mso:TemplateUrl msdt:dt="string"></mso:TemplateUrl>
<mso:ContentTypeId msdt:dt="string">0x0101002C05377DDBA1DA4998D7B8B3F4A9A863</mso:ContentTypeId>
<mso:TriggerFlowInfo msdt:dt="string"></mso:TriggerFlowInfo>
<mso:_SourceUrl msdt:dt="string"></mso:_SourceUrl>
<mso:_SharedFileIndex msdt:dt="string"></mso:_SharedFileIndex>
</mso:CustomDocumentProperties>
</xml><![endif]-->
</HEAD>
<BODY background="../bgrwhite.gif">
      <CENTER><B>ﾓ&#57517;・X</B></CENTER></FONT>
      <P>
      <P align=center><FONT color=black face=ARIAL size=4>ﾏ&#57517;裲&#57887;&#57517;籵湜・
      蒻琿魲魵鵫 ・淲・</FONT></P>
ﾑ裨&#58819;・・ 粨銛琿・・
            &#57706;&#57517;裲&#57887;&#57522;褌 蒻琿魲魵・ ・淲・. ﾄ・ &#63729;&#57893;胛 粹璞琿・糺礪&#57508;&#57884; 鈞・琅・ 
            <B>"Resourse View"</B> ・&#57503;&#57701;&#57517;鶯・・渼・<B>FourUp Resource</B>. 
            ﾂ靃鸙湜&#57884; &#57702;蒟・&#59203;・蒟鴦&#57881;・ <BR>
            <UL type=square>
              <LI>ﾓ 浯・淲 碯蒟・湜 ・・・・ⅰ鶴, 濵 ・浯・碯蒟・・・, ・糺 裙・
              &#57696;鴒瑰 蒡矜粨&#57884;. 
              <LI>ﾄ髜珞・・・・ &#57693;鵫 ・鮱・ ・・・&#59223;&#63730; <B>WorkSpace</B>. ﾎ&#57889;&#57517;鶯・
              鈞・琅・ ・&#57508;&#57710;&#57520;瑟・ 糺鉋粨&#57884; ・炅裲&#57704;鮱 ・・, &#57879;・浯鱠頸・
              <B>Insert...</B>, ・&#63731;粨&#57896;&#63731; &#57879;・・蒻琿魲魵鮱 鶴濵: 
              <P align=center><IMG src="lesson010.files/vc_insert_icon.gif"></P>
              <LI>ﾒ襃褞・&#57706;&#57517;裲&#57887;&#57522;褌 ・・. ﾙ褄・頸・・ 浯鈔瑙・ ・・ 葢・&#57503;鈞, 
              ・鶴淲 ・鮱・頏魵瑙・ 蒡矜紆&#57884; 粹璞琿・・渼・&#58255;鴉 <B>File</B>, 
              ・&#57893;・・&#57503;&#57701;&#57530;糲褌・ 湜趺 鶴ⅹ・, 蒡矜紆&#57884; ・渼・<B>Open...</B>, ・
              襌・湜趺 蒡矜紆&#57884; ・渼・<B>Exit</B>. ﾂ 鶴淲 ・ⅰ褞&#57887;・・湜&#58824;胛 淲 
              ・・鶯・ 
              <LI>ﾄ・ &#57503;碚&#57906; c <B>bmp</B> &#58255;鴉瑟・籵・淲髜&#58457;蒻・ 碯蒟・&#57701;璞瑣・
              葢・&#58255;鴉・ 浯&#58457;・&#59203;&#58460;&#63731; ・ 琅&#57508;&#57710; <A            href="http://click.ipc.ru/~vc/html/Lessons/Lessons/Visual%20Progs/MFC_Source/ln10res.zip"><B>http://click.ipc.ru/~vc/html/Lessons/
Lessons/Visual%20Progs/MFC_Source/ln10res.zip</B></A>, 
              ・&#57893;&#57530;・炫跫・碯蒟・蒡矜粨&#57907; ・・鮱・. 
              <LI>ﾗ&#57893;磊 蒡矜粨&#57907; ・・鮱・ &#58255;鴉・ 淲髜&#58457;蒻・, 鈞鶯・・
              <B>Project-&gt;Add to Project-&gt;Files...</B> 糺砒&#57511;&#57884; &#63729;&#57887; 葢・
              &#58255;鴉・ <B>dib.cpp</B> ・<B>Showdib.h</B>. 
              <LI>ﾄ髜珞・・&#57702;裝・&#59214;&#63730; &#57709;&#57517;・ ・&#58255;鴉 <B>BmpOpenDlg.cpp</B>: 
              <BR><B>#include"Showdib.h"</B>. 
              <LI>ﾝ&#57879; &#58255;鴉 鈞胛・粲魵 &#58274;渼&#58639;・ ・&#57702;・&#63729;&#57893;胛 糺 ・趺&#57884; 
              頌・・鉋籵&#57907; &#58274;渼&#58639;・ 蓁&#63731; ⅳ・靑・ <B>BMP</B> &#58255;鴉魵. 
              <LI>ﾒ襃褞・&#57693;&#63731;趺・・・・・渼&#57893;・・・ <B>Exit</B>. 
              <LI>ﾎ&#57889;&#57517;鶯・<B>ﾑlass Wizard</B> 浯 &#57709;&#57503;湜&#58636; <B>Message Maps</B>, 
              粽銕鮻濵 ・籵・・&#63731;粨&#57896;&#63731; 鶴濵, ・・&#57893;&#57517;・碯蒟・・裝・聰&#57907;・ &#57705;鈕瑣・
              齏・糺碣瑣・・瑰・蓁&#63731; ・・, 浯跪頸・鈕褥・<B>Cancel</B>. 
              <LI>ﾂ鎤褞頸・竟蒟&#57887;&#58263;・&#57893;・<B>ID_FILE_EXIT</B> ・&#57705;磊&#57887;・
              <B>BN_CLICKED</B>, 蒡矜紆&#57884; &#58274;渼&#58639;&#63730; ・浯・&#59015;&#57884; ・淲・
              <B>OnOK();</B>. 
              <LI>ﾝ&#57879; &#58274;渼&#58639;&#63731; 鈞粢&#57527;瑯・&#57503;碚&#57898; ・魲&#57503;・・ 
              <LI>ﾄ髜珞・・葢・・&#57508;・澵鐱 ・・瑰・<B>CBmpOpenDlg</B>: <BR>1) 
              ﾒ韵: <B>BITMAP</B>, 浯鈔瑙韃 <B>bm</B>.<BR>2) ﾒ韵: <B>HBITMAP</B>, 
              浯鈔瑙韃 <B>hbm</B>.<BR>
              <LI>ﾏ褞籵&#63731; ・&#57508;・澵・ 碯蒟・&#58459;瑙頸・・&#57503;・&#57895;・韈髜&#57503;趺湜&#63731;, &#57879;・・
              ・・&#57503;銕褞 ・・・ 
              <LI>ﾂ&#57893;&#57503;&#63731; ・&#57508;・澵・, &#63729;&#57893; &#58077;珸瑣褄・浯 髜栁・ ・&#57521;竟・ ・・・&#57887;, 
              ・・・&#59223;&#63730; 淲・・ 碯蒟・ 糺粽蒻&#57907; ・&#57521;竟・. 
              <LI>ﾑ・跖&#57884; &#57879;・・趺 髜&#57503;鉋・・・・・渼&#57893;・<B>ID_FILE_OPEN</B>. 
              <LI>ﾈ 蒡矜紆&#57884; &#57702;裝・&#59203;・・・&#57898;萵:
              <P><B>void CMPODlg::OnFileOpen() <BR>{<BR>//ﾇ璢鸙魵鶴 ・・&#57907; ・
              &#58255;鴉・BR>char FileName[500];<BR>char 
              FileTitle[100];<BR>FileName[0]='\0';
              <P>//ﾑ鰀萵&#57907; 髜栁・ 蒻琿魲魵魲・鶴浯 <BR>CFileDialog 
              file(TRUE);<BR>//ﾓ&#57709;珞濵粨&#57907; 瑣&#57895;鞦&#58085;・蒻琿魲魵魲・
              鶴浯<BR>file.m_ofn.lpstrFilter=TEXT("Bitmap picture files 
              *.bmp\0*.bmp\0All Files 
              *.*\0*.*\0\0");<BR>file.m_ofn.lpstrFileTitle=FileTitle;<BR>file.m_ofn.lpstrFile=FileName;<BR>file.m_ofn.lpstrTitle="Open 
              BMP File";<BR>//ﾂ鏆褥&#57887; 蒻琿魲魵鮱 鶴濵<BR>file.DoModal();
              <P>//ﾅ&#57702;・湜&#58824;胛 淲 糺碣瑙濵, &#57893; 粢&#57516;&#58085;・&#63731;<BR>if 
              (FileName[0]=='\0')return;<BR>//ﾈ銕褊頸・鈞胛・粽・鶴浯 浯 韲&#63731; 
              &#58255;鴉・BR>SetWindowText(FileTitle);
              <P>//ﾏ鸙&#58090;頸・&#58077;珸瑣褄・浯 髜栁・ ・・・&#57887;<BR>HANDLE hdibCurrent1 
              = OpenDIB(FileName);<BR>hbm=0;
              <P>//ﾏ鸙&#58090;頸・&#58077;珸瑣褄・浯 
              韈髜&#57503;趺湜・BR>hbm=BitmapFromDib(hdibCurrent1,0);
              <P>//ﾇ瑜頌瑣・・&#57503;・&#57895;・韈髜&#57503;趺湜&#63731; 
              <BR>GetObject(hbm,sizeof(BITMAP),(LPSTR)&amp;bm);
              <P>//ﾏ鸙&#58090;頸・・ⅱ蒻浯&#57906; 鶴浯<BR>CRect 
              wdRect;<BR>GetClientRect(&amp;wdRect);<BR>ClientToScreen(&amp;wdRect);
              <P>//ﾈ銕褊頸・&#57503;銕褞・
              鶴浯<BR>SetWindowPos(NULL,wdRect.left-4,wdRect.top-42,
bm.bmWidth+wdRect.left,bm.bmHeight+wdRect.top,NULL);
              <P>//ﾂ鏆褥&#57887; ・&#57521;竟・<BR>OnPaint();<BR>}
              <P></B></P>
              <LI>ﾂ浯&#58819;・ 糺 &#57705;鈕瑯&#57884; 髜栁・ 蒻琿魲魵魲・鶴浯 ⅳ・靑・ &#58255;鴉・ 
              ・&#57893;・&#58084;&#57879;浯粱鞣瑯&#57884; 裙・瑣&#57511;碯&#57906;, 糅鮏・&#57887;・ &#58255;鴉魵, 鈞胛・粽・
              鶴浯, ・萵 鈞・&#57718;籵&#57907; ・&#57907; ・浯鈔瑙韃 &#58255;鴉・ 
              <LI>ﾏⅳ黑 糺 糺粽蒻&#57884; &#63729;&#57893; 鶴濵, 褥・ 湜&#58824;胛 淲 糺碣瑙濵, &#57893; 糺 
              粽銜瓊瑯&#57884;&#57719;. 
              <LI>ﾇ瑣褌 糺 韈・・褪・鈞胛・粽・鶴浯 浯 韲&#63731; &#58255;鴉・ 
              <LI>ﾐ珸・&#59195;褪・髜栁・ ・・・&#57887;, ・&#57893;・髜&#57503;碚&#57906;籵褪・裙・ ・・&#58819;褪・
              &#58077;珸瑣褄・浯 髜栁・, 鈞&#57884;・・・&#58819;褪・&#58077;珸瑣褄・浯 韈髜&#57503;趺湜・ 
              <LI>ﾇ瑜頌鏆瑯&#57884; ・&#57503;・&#57895;・韈髜&#57503;趺湜&#63731; ・・&#57508;・澵・ <B>bm</B>. 
              <LI>ﾏ鸙&#58090;瑯&#57884; &#57503;銕褞・鶴浯, ・・鈞粨&#57699;・&#57709;・ⅳ &#57503;銕褞・韈髜&#57503;趺湜&#63731; 
              韈・・褪・&#57503;銕褞 鶴浯. 
              <LI>ﾇ瑣褌 糺鍄籵褪・ &#58274;渼&#58639;&#63731; &#57511;&#57705;籵湜&#63731; 鶴浯 <B>OnPaint()</B>, 
              &#57696;鴒瑰 ・ 蒡矜粨・&#57898;萵 ・・
              <P><B>void CMPODlg::OnPaint() <BR>{<BR>if 
              (IsIconic())<BR>{<BR>.........<BR>}<BR>else<BR>{
              <P>////-ﾂ璧 ・・浯&#58827;浯褪・ 鈕褥・////
              <P>//ﾅ&#57702;・ⅳ・靑 bmp &#58255;鴉<BR>if(hbm) { CClientDC dc(this);
              <P>//ﾏ鸙&#58090;頸・&#58077;珸瑣褄・浯 DC.
              <P>HDC hdc=::GetDC(m_hWnd);<BR>HDC 
              hdcBits=::CreateCompatibleDC(hdc);
              <P>//ﾂ鎤&#57503;&#57907; 髜栁・<BR>SelectObject(hdcBits,hbm);
              <P>//ﾇ瑕&#57503;&#57699;&#57907; ・韃炅&#57701;・ 髜・c&#57907; &#58824;&#57516;隯 &#58633;褪黑<BR>CRect 
              wdRect;<BR>GetClientRect(&amp;wdRect);<BR>CBrush 
              brush;<BR>brush.CreateSolidBrush(RGB(0,0,0));<BR>dc.FillRect(&amp;wdRect,&amp;brush);
              <P>//ﾂ鏆褥&#57887; 韈髜&#57503;趺湜・BR>BitBlt(hdc, 0, 0, 
              bm.bmWidth,bm.bmHeight,hdcBits,0,0, SRCCOPY);
              <P>//ﾓ萵・&#57907; 
              DC<BR>DeleteDC(hdcBits);<BR>::ReleaseDC(m_hWnd,hdc);<BR>}
              <P>////-ﾂ璧 ・・鈞・煆鞣瑯&#57896;&#63731; 鈕褥・////
              <P>CDialog::OnPaint();<BR>}<BR>}<BR></B></P>
              <LI>ﾎ・&#57503;&#57893;・<B>IF</B> ・魵褞&#63731;褪 磊・ ・ ⅳ・靑・韈髜&#57503;趺湜・ 
              <LI>ﾇ瑣褌 糺 ・・&#58819;褪・&#58077;珸瑣褄・浯 <B>DC</B>, ・&#57705;鈕瑯&#57884; 
              ・・・燾・<B>DC</B>. 
              <LI>ﾂ鎤頏瑯&#57884; <B>DC</B>. 
              <LI>ﾇ瑕&#57503;&#59015;籵褪・&#63729;・瑙 &#58824;&#57516;隯 &#58633;褪黑. 
              <LI>ﾏⅳ黑 糺粽蒻&#57884; 韈髜&#57503;趺湜・ 砒・・&#57715;&#57879;礪&#57517;籵湜&#63731;. ﾄ・ 
              ・&#59025;珮頏魵瑙・ 頌・・銛褪・ &#58274;渼&#58639;&#63731; <B>StretchBlt</B>. 
              <LI>ﾇ瑣褌 糺 &#58071;琿&#63731;褪・<B>DC</B>. 
              <LI>ﾒ襃褞・蒡矜紆&#57884; ・・瀨&#57895;&#58077;&#57893;・・瑰&#57691; <B>CBmpOpenDlg</B> 
              &#57702;裝・&#59214;&#63730; &#57709;&#57517;・: <BR><B>hbm=0;</B>. 
              <LI>ﾝ&#57893; 鈿璞頸, &#58837;・・・鈞・&#57701;・&#58274;渼&#58639;・<B>OnPaint()</B>, ・&#57521;竟・ 
              淲 碯蒟・&#57511;&#57705;籵&#57907;・, ・・ 蒡 裹 ⅳ・靑・. 
              <LI>ﾂⅳ 糅鮏・・糂・ ﾓ萵&#58827;. 
              <P<div align="center">><BR><BR>ﾂ 浯&#58819;・<BR><A 
              href="lesson000.htm"><B 
              class=base2>&lt;-ﾍ珸琅</B></A> </div>
      </P></LI></UL></FONT>
<p><div align="center"><a href="lesson.htm"><img src="../soder.gif" width=120 height=31 border=0 alt=""></a></div></p>			  
	  </BODY></HTML>
